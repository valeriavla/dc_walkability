<!DOCTYPE html>
<meta charset="utf-8">
<body>
  <script src="http://d3js.org/d3.v3.min.js"></script>
  <script src="https://rawgit.com/jasondavies/d3-cloud/master/build/d3.layout.cloud.js"></script>
  <script>

//Based on https://github.com/jasondavies/d3-cloud/blob/master/examples/simple.html

// Encapsulate the word cloud functionality
function wordCloud(selector) {
    var fill = d3.scale.category20();
    var svg = d3.select(selector).append("svg")
        .attr("width", 500)
        .attr("height", 500)
        .append("g")
        .attr("transform", "translate(250,250)");

        function draw(words) {
        var cloud = svg.selectAll("g text")
                        .data(words, function(d) { return d.text; })
        cloud.enter()
            .append("text")
            .style("font-family", "Impact")
            .style("fill", function(d, i) { return fill(i); })
            .attr("text-anchor", "middle")
            .attr('font-size', 1)
            .text(function(d) { return d.text; });

        //Entering and existing words
        cloud
            .transition()
                .duration(600)
                .style("font-size", function(d) { return d.size + "px"; })
                .attr("transform", function(d) {
                    return "translate(" + [d.x, d.y] + ")rotate(" + d.rotate + ")";
                })
                .style("fill-opacity", 1);

        //Exiting words
        cloud.exit()
            .transition()
                .duration(200)
                .style('fill-opacity', 1e-6)
                .attr('font-size', 1)
                .remove();
    }

    return {

update: function(words) {
            d3.layout.cloud().size([500, 500])
                .words(words)
                .padding(5)
                .rotate(function() { return ~~(Math.random() * 2) * 90; })
                .font("Impact")
                .fontSize(function(d) { return d.size; })
                .on("end", draw)
                .start();
        }
    }

}

var words = [
"bike bike bike bike bike bike bike bike bike bike bike bike bike bike get get get get get would would would would one one one one lanes lanes lanes lanes good good good good trail trail trail st st st lane lane lane park park park also also also like like like street street street city city mbt mbt bikes bikes many many ride ride dont dont trails trails way way pretty pretty people people th th go go rock rock creek creek nw nw map map take take",
"car metro metro metro metro metro metro metro car car car car car car traffic traffic traffic traffic traffic speed speed speed speed speed people people people people people drive drive drive drive like like like like get get get get city city city driving driving driving time time time one one think think go go tickets tickets cameras cameras live live cars cars bike bike need need even even use use drivers drivers every every day day work work take take camera camera make make limit limit",
"walk people people people people people people people people people city city city city city city city city like like like like like like like car car car car car get get get get live live live one one one much much much think think think philly philly philly really really really lot lot metro metro love love cars cars time time even even many many cities cities better better good good great great thats thats way way go go years years place place want want things things lived lived "
]

function getWords(i) {
return words[i]
    .replace(/[!\.,:;\?]/g, '')
    .split(' ')
    .map(function(d) {
        return {text: d, size: 10 + Math.random() * 60};
    })
}

function showNewWords(vis, i, updateCallback) {
    i = i || 0;

    vis.update(getWords(i ++ % words.length));
    updateCallback();
}

var myWordCloud = wordCloud('body');
var titles = [
    "Walk","Bikes","Cars"
]

d3.select('body').append('button')
    .on('click', function() {
        myWordCloud.update(getWords(Math.floor(Math.random() * words.length)));
    })
    
    .text("Cars Word cloud");
</script>